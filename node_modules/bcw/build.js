#!/usr/bin/env node
let basePath = process.cwd();
const ParcelBundler = require('parcel-bundler');
/**
 * @type {import('parcel-bundler').ParcelOptions}
 */
let options = {
  hmr: false,
  watch: false,
  cache: false,
  publicUrl: "./",
  bundleNodeModules: true,
  minify: true,
  sourceMaps: false,
  outDir: "dist"
}
async function start() {
  console.log("BASEPATH: ", basePath)
  processArgs()
  let b = new ParcelBundler(basePath + "/*.html", options)
  try {
    await b.bundle()
    console.log(`
Bundle Ready at ${basePath}/${options.outDir}
    `)
  } catch (e) {
    console.error(e)
  }
}


function processArgs() {
  try {
    if (process.argv) {
      process.argv.find((a, i) => {
        if (a.includes("-o")) {
          options.outDir = process.argv[i + 1];
          return true;
        }
      });
    }
  } catch (error) {
    console.error(error);
  }
}

start()